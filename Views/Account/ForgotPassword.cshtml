@model WebApp.ViewModels.ForgotPasswordViewModel
@{
    Layout = "_AccountLayout";
    ViewData["Title"] = "Forgot Password";
}

<form class="card-body flex flex-col gap-5 p-10" method="post" asp-controller="Account" asp-action="ForgotPassword">
    <div class="text-center mb-2.5">
        <h3 class="text-lg font-medium text-gray-900 leading-none mb-2.5">
            Forgot Password
        </h3>
        <div class="flex items-center justify-center font-medium">
            <span class="text-2sm text-gray-700 me-1.5">
                Введіть ваш email для відновлення пароля
            </span>
        </div>
    </div>

    @if (TempData["SuccessMessage"] != null)
    {
        <div class="bg-green-100 border border-green-300 text-green-800 p-3 rounded mb-4">
            <p class="mb-0 font-medium">@TempData["SuccessMessage"]</p>
        </div>
    }

    @if (TempData["ErrorMessage"] != null)
    {
        <div class="bg-red-100 border border-red-300 text-red-800 p-3 rounded mb-4">
            <p class="mb-2 font-medium">@TempData["ErrorMessage"]</p>

            <!-- ДОДАЙТЕ ЦЕЙ БЛОК ДЛЯ GOOGLE-КОРИСТУВАЧІВ -->
            @if (TempData["ErrorMessage"].ToString().Contains("Google"))
            {
                <div class="mt-3 p-3 bg-yellow-50 border border-yellow-200 rounded">
                    <p class="text-sm font-medium text-yellow-800 mb-2">
                        <i class="bi bi-google me-1"></i> Google-акаунт
                    </p>

                    <div class="space-y-2">
                        <p class="text-sm text-yellow-700 mb-0">
                            Оберіть один з варіантів:
                        </p>

                        <div class="flex flex-col gap-2">
                            <a class="btn btn-sm btn-outline-primary flex items-center justify-center gap-2"
                               asp-controller="Account" asp-action="GoogleLogin">
                                <img alt="Google" class="size-4" src="~/assets/media/brand-logos/google.svg" />
                                Увійти через Google
                            </a>

                            <a class="btn btn-sm btn-outline-warning flex items-center justify-center gap-2"
                               asp-controller="Account" asp-action="AddPassword">
                                <i class="bi bi-key"></i>
                                Встановити пароль
                            </a>

                            @if (User?.Identity?.IsAuthenticated == true)
                            {
                                <a class="btn btn-sm btn-outline-secondary flex items-center justify-center gap-2"
                                   asp-controller="Account" asp-action="Profile">
                                    <i class="bi bi-person-circle"></i>
                                    Мій профіль
                                </a>
                            }
                        </div>
                    </div>
                </div>
            }
        </div>
    }

    <div class="flex flex-col gap-1">
        <label class="form-label font-normal text-gray-900">Email</label>
        <input asp-for="Email" class="input" placeholder="email@email.com" type="email" required />
        <span asp-validation-for="Email" class="text-danger"></span>
    </div>

    <button class="btn btn-primary flex justify-center grow" type="submit">
        <i class="bi bi-envelope me-2"></i> Надіслати код відновлення
    </button>

    <!-- ДОДАТКОВА ІНФОРМАЦІЯ -->
    <div class="mt-4 p-3 bg-blue-50 border border-blue-200 rounded">
        <p class="text-sm font-medium text-blue-800 mb-1">
            <i class="bi bi-info-circle me-1"></i> Інформація:
        </p>
        <ul class="text-sm text-blue-700 space-y-1">
            <li>• Звичайні email-акаунти можуть відновити пароль</li>
            <li>• Google-акаунти <strong>з власним паролем</strong> можуть відновити пароль</li>
            <li>• Google-акаунти <strong>без пароля</strong> можуть увійти тільки через Google</li>
        </ul>
    </div>

    <div class="text-center pt-4">
        <a class="text-2sm link flex items-center justify-center gap-1" href="/Account/LoginIn">
            <i class="bi bi-arrow-left"></i> Повернутися до входу
        </a>
    </div>
</form>